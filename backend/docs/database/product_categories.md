# 🗂 Table: product_categories

---

Οργανώνει τα προϊόντα σε **κατηγορίες** (π.χ. Εργαλεία, Καύσιμα, Ρούχα, Υλικά Οικοδομών).  
Οι κατηγορίες βοηθούν στο φιλτράρισμα, στην ταξινόμηση, στο UI και σε reports.  
Κάθε εταιρεία μπορεί να έχει τις δικές της custom κατηγορίες.

**Works with:**
- `companies` → η εταιρεία στην οποία ανήκει η κατηγορία
- `products` → κάθε προϊόν μπορεί να ανήκει σε μία (προαιρετική) κατηγορία
- `product_variants` (έμμεσα) → οι παραλλαγές ανήκουν στο προϊόν, άρα κληρονομούν την κατηγορία
- `plugin_industries` / `plugins` (έμμεσα) → κάποια plugins μπορεί να προσθέτουν ειδικές product categories

Χρησιμοποιείται για:
- ταξινόμηση προϊόντων στο UI,
- φίλτρα αναζήτησης,
- οργάνωση POS και καταλόγου προϊόντων,
- reports όπως “πωλήσεις ανά κατηγορία”,
- ευκολότερη διαχείριση μεγάλων καταλόγων προϊόντων.

Δεν επηρεάζει permissions ούτε stock — είναι καθαρά οργανωτικός πίνακας.

---

## 📌 1. Fields Definition

| Field | Type | Null | Default | Description |
|--------|---------|------|----------|-------------|
| id (PK) | ΙΝΤ | NOT NULL | AUTO-INCREMENT | Unique product category identifier |
| company_id (FK) | UUID | NOT NULL | — | References companies(id). Categories are company-specific |
| name | TEXT | NOT NULL | — | Category name (e.g., "Aggregates", "Fuel Types", "Clothing") |
| parent_id (FK) | ΙΝΤ | NULL | — | Self-reference to support nested categories |
| created_at | TIMESTAMP | NOT NULL | NOW() | Creation timestamp |

---

## ℹ️ Notes

- Κάθε εταιρεία έχει το δικό της category tree.
- Υποστηρίζει **ιεραρχία κατηγοριών** (parent → child).
- Μπορεί να χρησιμοποιηθεί από plugins για ειδικές κατηγορίες (π.χ., fuel types).
- Προτείνω να μην επιτρέπεις πολλά επίπεδα nested ιεραρχίας (max 2–3).

---

## 📌 2. Example Rows

| id | company_id | name              | parent_id | created_at          |
| -- | ---------- | ----------------- | --------- | ------------------- |
| 1  | comp-1111  | Υλικά             | NULL      | 2025-01-01 10:00:00 |
| 2  | comp-1111  | Αδρανή Υλικά      | 1         | 2025-01-01 10:00:01 |
| 3  | comp-1111  | Άμμος             | 2         | 2025-01-01 10:00:02 |
| 4  | comp-1111  | Είδη Καυσίμων     | NULL      | 2025-01-01 10:00:03 |
| 5  | comp-1111  | Πετρέλαιο Κίνησης | 4         | 2025-01-01 10:00:04 |
| 6  | comp-2222  | Ρούχα             | NULL      | 2025-01-01 10:00:05 |
| 7  | comp-2222  | Μπλούζες          | 6         | 2025-01-01 10:00:06 |

---

## 📌 3. SQL: CREATE TABLE (Supabase)

```sql
CREATE TABLE product_categories (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,

  company_id UUID NOT NULL REFERENCES companies(id) ON DELETE CASCADE,
  name TEXT NOT NULL,

  parent_id BIGINT NULL REFERENCES product_categories(id) ON DELETE SET NULL,

  created_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE UNIQUE INDEX product_categories_unique_tree_name
ON product_categories (company_id, parent_id, name);

CREATE INDEX idx_product_categories_company_id ON product_categories(company_id);
CREATE INDEX idx_product_categories_parent_id ON product_categories(parent_id);
```

---

## 📌 4. SQL: Insert Demo Data

```sql
INSERT INTO product_categories 
  (company_id, name, parent_id)
VALUES
  -- Εταιρεία 1 (Μάντρα οικοδομικών υλικών)
  ('comp-1111', 'Υλικά', NULL),
  ('comp-1111', 'Αδρανή Υλικά', 1),
  ('comp-1111', 'Άμμος', 2),
  ('comp-1111', 'Είδη Καυσίμων', NULL),
  ('comp-1111', 'Πετρέλαιο Κίνησης', 4),

  -- Εταιρεία 2 (Ρούχα)
  ('comp-2222', 'Ρούχα', NULL),
  ('comp-2222', 'Μπλούζες', 6);

```
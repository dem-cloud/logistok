# ğŸ—‚ Table: plans

---

Î ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î± **Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± subscription plans** Ï„Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ (Ï€.Ï‡. Basic, Pro, Enterprise).  
ÎšÎ¬Î¸Îµ plan Î¿ÏÎ¯Î¶ÎµÎ¹ Ï„Î¿ Î¼Î·Î½Î¹Î±Î¯Î¿ Î® ÎµÏ„Î®ÏƒÎ¹Î¿ ÎºÏŒÏƒÏ„Î¿Ï‚, Ï„Î· Î¼Î­Î³Î¹ÏƒÏ„Î· ÎµÏ€Î¹Ï„ÏÎµÏ€ÏŒÎ¼ÎµÎ½Î· Ï‡ÏÎ®ÏƒÎ· (Ï€.Ï‡. Î±ÏÎ¹Î¸Î¼ÏŒÏ‚ Ï‡ÏÎ·ÏƒÏ„ÏÎ½ Î® ÎºÎ±Ï„Î±ÏƒÏ„Î·Î¼Î¬Ï„Ï‰Î½), ÎºÎ±Î¸ÏÏ‚ ÎºÎ±Î¹ ÎµÎ¹Î´Î¹ÎºÎ¬ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬/Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿ÏÏ‚.

Î¤Î± plans ÎµÎ¯Î½Î±Î¹ global ÎºÎ±Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Î³Î¿ÏÎ¬ Î® Î±Î»Î»Î±Î³Î® ÏƒÏ…Î½Î´ÏÎ¿Î¼Î®Ï‚.

**Works with:**
- `subscriptions` â†’ ÎºÎ¬Î¸Îµ ÎµÏ„Î±Î¹ÏÎµÎ¯Î± Î­Ï‡ÎµÎ¹ Î­Î½Î± ÎµÎ½ÎµÏÎ³ÏŒ subscription plan
- `subscription_items` â†’ Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¹Ï‚ ÎµÏ€Î¹Î¼Î­ÏÎ¿Ï…Ï‚ Ï‡ÏÎµÏÏƒÎµÎ¹Ï‚ Î³Î¹Î± plan, add-ons ÎºÎ±Î¹ extra stores
- `company_plugins` (Î­Î¼Î¼ÎµÏƒÎ±) â†’ ÎºÎ¬Ï€Î¿Î¹Î± plans Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½ plugins by default
- `onboarding` â†’ ÎµÏ€Î¹Î»Î¿Î³Î® plan ÏƒÏ„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ Î²Î®Î¼Î±
- `stripe` (Î­Î¼Î¼ÎµÏƒÎ±) â†’ Ï„Î± plan rows ÏƒÏ…Î½Î´Î­Î¿Î½Ï„Î±Î¹ Î¼Îµ Stripe price IDs Î³Î¹Î± billing

Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î±:
- Î´Î¹Î±Î¼ÏŒÏÏ†Ï‰ÏƒÎ· pricing model (monthly/yearly),
- Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¹ÏƒÎ¼ÏŒ Î¿ÏÎ¯Ï‰Î½ Ï‡ÏÎ®ÏƒÎ·Ï‚ (Ï€.Ï‡. max users, max stores),
- ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ·/Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· features Î±Î½Î¬ tier,
- billing integration Î¼Îµ Stripe,
- Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î±ÏƒÎ· Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Ï‰Î½ Ï€Î±ÎºÎ­Ï„Ï‰Î½ ÏƒÏ„Î¿ UI.

Î‘Ï€Î¿Ï„ÎµÎ»ÎµÎ¯ Ï„Î· Î²Î¬ÏƒÎ· Ï„Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ ÏƒÏ…Î½Î´ÏÎ¿Î¼ÏÎ½ ÎºÎ±Î¹ Ï„Î¹Î¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚.

---

## ğŸ“Œ 1. Fields Definition

| Field | Type | Null | Default | Description |
|--------|--------|------|----------|-------------|
| id (PK) | UUID | NOT NULL | gen_random_uuid() | Unique plan identifier |
| key | TEXT | NOT NULL | â€” | Unique string key for the plan (e.g., "basic", "pro", "business") |
| name | TEXT | NOT NULL | â€” | Display name of the plan |
| description | TEXT | NULL | â€” | Description of the plan |
| max_users_per_store | INT | NULL | â€” | Max number of users included |
| features | JSONB | NULL | â€” | Features available for this plan |
| stripe_price_id_monthly | TEXT | NULL | â€” | Stripe price ID for monthly billing |
| stripe_price_id_yearly | TEXT | NULL | â€” | Stripe price ID for yearly billing |
| stripe_extra_store_price_id | TEXT | NULL | â€” | Stripe price ID for extra store monthly billing |
| is_public | BOOLEAN | NOT NULL | FALSE | Whether customers can select this plan |
| priority | INT | NOT NULL | 100 | Ordering in the UI (lower = higher priority) |
| created_at | TIMESTAMP | NOT NULL | NOW() | When record was created |

---

## ğŸ“Œ 2. Example Rows

| id       | key        | name       | description                           | max_users_per_store | features                                                              | stripe_price_id_monthly | stripe_price_id_yearly | stripe_extra_store_price_id | is_public | priority | created_at          |
| -------- | ---------- | ---------- | ------------------------------------- | ------------------- | --------------------------------------------------------------------- | ----------------------- | ---------------------- | --------------------------- | --------- | -------- | ------------------- |
| plan-001 | basic      | Basic      | Î’Î±ÏƒÎ¹ÎºÏŒ Ï€Î±ÎºÎ­Ï„Î¿ Î³Î¹Î± Î¼Î¹ÎºÏÎ­Ï‚ ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ®ÏƒÎµÎ¹Ï‚ | 1                   | {"reports": false, "plugins_allowed": []}                             | NULL                    | NULL                   | NULL                        | TRUE      | 1        | 2025-01-01 10:00:00 |
| plan-002 | pro        | Pro        | Î Î»Î®ÏÎµÏ‚ Ï€Î±ÎºÎ­Ï„Î¿ Î³Î¹Î± ÎµÏ€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¯ÎµÏ‚       | 10                  | {"reports": true, "plugins_allowed": ["reporting"]}                   | price_123abc            | price_year_123abc      | price_extra_111             | TRUE      | 2        | 2025-01-01 10:00:01 |
| plan-003 | business   | Business   | Î“Î¹Î± ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ®ÏƒÎµÎ¹Ï‚ Î¼Îµ Ï€Î¿Î»Î»Î­Ï‚ Î±Î½Î¬Î³ÎºÎµÏ‚    | NULL                  | {"reports": true, "priority_support": true, "plugins_allowed": ["*"]} | price_999aaa            | price_year_999aaa      | price_extra_999             | TRUE      | 3        | 2025-01-01 10:00:02 |
| plan-004 | exclusive | Exclusive Access | Custom Ï€Î±ÎºÎ­Ï„Î¿ Î¼ÏŒÎ½Î¿ Î¼Î­ÏƒÏ‰ Ï€Ï‰Î»Î·Ï„Î®        | NULL                | {"custom_contract": true}                                             | NULL                    | NULL                   | NULL                        | FALSE     | 100      | 2025-01-01 10:00:03 |

---

## ğŸ“Œ 3. SQL: CREATE TABLE (Supabase)

```sql
CREATE TABLE plans (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  key TEXT NOT NULL UNIQUE,
  name TEXT NOT NULL,
  description TEXT NULL,

  features JSONB NULL,

  -- Business logic
  included_branches INT NOT NULL DEFAULT 0,
  max_users_per_store INT NULL CHECK (max_users_per_store > 0),
  allows_paid_plugins BOOLEAN NOT NULL DEFAULT TRUE,
  is_free BOOLEAN NOT NULL DEFAULT FALSE,

  -- Stripe = source of truth
  stripe_price_id_monthly TEXT NULL,
  stripe_price_id_yearly TEXT NULL,
  stripe_extra_store_price_id_monthly TEXT NULL,
  stripe_extra_store_price_id_yearly TEXT NULL,

  -- Cache for UI only (NOT billing)
  cached_price_monthly DECIMAL(10,2) NULL,
  cached_price_yearly DECIMAL(10,2) NULL,
  cached_extra_store_price_monthly DECIMAL(10,2) NULL,
  cached_extra_store_price_yealry DECIMAL(10,2) NULL,
  cached_currency TEXT NOT NULL DEFAULT 'EUR',
  cached_updated_at TIMESTAMP NULL,

  -- UI / ordering
  is_public BOOLEAN NOT NULL DEFAULT FALSE,
  priority INT NOT NULL DEFAULT 100,
  rank INT NOT NULL DEFAULT 1,
  is_popular BOOLEAN NOT NULL DEFAULT FALSE,

  created_at TIMESTAMP NOT NULL DEFAULT now(),
  updated_at TIMESTAMP NOT NULL DEFAULT now()
);


CREATE INDEX idx_plans_is_public ON plans(is_public, priority);
```

---

## ğŸ“Œ 4. SQL: Insert Demo Data

```sql
INSERT INTO plans
  (key, name, description, max_users_per_store, features,
   stripe_price_id_monthly, stripe_price_id_yearly, stripe_extra_store_price_id,
   is_public, priority)
VALUES
  -- Basic (free)
  (
    'basic',
    'Basic',
    'Î’Î±ÏƒÎ¹ÎºÏŒ Ï€Î±ÎºÎ­Ï„Î¿ Î³Î¹Î± Î¼Î¹ÎºÏÎ­Ï‚ ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ®ÏƒÎµÎ¹Ï‚',
    1,
    '{"reports": false, "plugins_allowed": []}'::jsonb,
    NULL,
    NULL,
    NULL,
    TRUE,
    1
  ),

  -- Pro
  (
    'pro',
    'Pro',
    'Î Î»Î®ÏÎµÏ‚ Ï€Î±ÎºÎ­Ï„Î¿ Î³Î¹Î± ÎµÏ€Î±Î³Î³ÎµÎ»Î¼Î±Ï„Î¯ÎµÏ‚',
    10,
    '{"reports": true, "plugins_allowed": ["reporting"]}'::jsonb,
    'price_123abc',
    'price_year_123abc',
    'price_extra_111',
    TRUE,
    2
  ),

  -- Business
  (
    'business',
    'Business',
    'Î“Î¹Î± ÎµÏ€Î¹Ï‡ÎµÎ¹ÏÎ®ÏƒÎµÎ¹Ï‚ Î¼Îµ Ï€Î¿Î»Î»Î­Ï‚ Î±Î½Î¬Î³ÎºÎµÏ‚',
    NULL,
    '{"reports": true, "priority_support": true, "plugins_allowed": ["*"]}'::jsonb,
    'price_999aaa',
    'price_year_999aaa',
    'price_extra_999',
    TRUE,
    3
  ),

  -- Exclusive (hidden)
  (
    'exclusive',
    'Exclusive Access',
    'Custom Ï€Î±ÎºÎ­Ï„Î¿ Î¼ÏŒÎ½Î¿ Î¼Î­ÏƒÏ‰ Ï€Ï‰Î»Î·Ï„Î®',
    NULL,
    '{"custom_contract": true}'::jsonb,
    NULL,
    NULL,
    NULL,
    FALSE,
    100
  );
```